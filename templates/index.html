<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Brainrot Drop</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;800;900&display=swap" rel="stylesheet">
    <!-- –ü–û–î–ö–õ–Æ–ß–ê–ï–ú –°–¢–ò–õ–ò -->
    <link rel="stylesheet" href="/static/css/styles.css?v=2">
</head>
<body>

    <div id="loading-screen"><div class="spinner"></div></div>

    <header>
        <div class="logo">üß† BRAINROT <span>DROP</span></div>
        <div class="balance-badge"><span class="star-icon">‚≠êÔ∏è</span> <span id="balance">0</span></div>
    </header>

    <main>
        <section id="tab-cases" class="tab-content active">
            <div id="cases-grid" class="cases-grid"></div>
        </section>

        <section id="tab-games" class="tab-content">
            <div id="active-game-ui" class="active-game-ui">
                <div id="game-loading-spinner" class="spinner" style="display:none; margin-bottom:20px;"></div>
                <h2 id="game-status-text">–û–∂–∏–¥–∞–Ω–∏–µ...</h2>
                <div id="game-controls" class="game-controls"></div>
                <button id="game-exit-btn" class="btn-secondary-danger" onclick="exitGame()">–í—ã–π—Ç–∏</button>
                <button id="game-cancel-btn" class="btn-secondary-danger" style="display:none" onclick="cancelActiveGame()">‚õî –û—Ç–º–µ–Ω–∏—Ç—å</button>
            </div>

            <div id="games-lobby">
                <div style="display:flex; gap:10px; margin:10px;">
                    <button class="main-action-btn" onclick="showCreateGameModal()">‚ûï –°–æ–∑–¥–∞—Ç—å –ò–≥—Ä—É</button>
                </div>
                <div id="games-list" class="games-list"></div>
            </div>
        </section>

        <section id="tab-upgrade" class="tab-content">
            <h2 style="text-align:center;margin-bottom:15px;color:var(--accent); font-size: 1.5rem; text-transform:uppercase; letter-spacing:1px; font-weight:800;">–ê–ø–≥—Ä–µ–π–¥</h2>
            <div class="upgrade-container">
                <div class="upgrade-slots">
                    <div id="u-slot-left" class="u-slot" onclick="openItemSelect('left')"><p>–ü–†–ï–î–ú–ï–¢</p></div>
                    <div class="u-arrow">‚û§</div>
                    <div id="u-slot-right" class="u-slot" onclick="openItemSelect('right')"><p>–¶–ï–õ–¨</p></div>
                </div>
                <div class="quick-chance-grid">
                    <button class="chance-btn" onclick="autoSelectTarget(50)">50%</button>
                    <button class="chance-btn" onclick="autoSelectTarget(30)">30%</button>
                    <button class="chance-btn" onclick="autoSelectTarget(20)">20%</button>
                    <button class="chance-btn" onclick="autoSelectTarget(10)">10%</button>
                </div>
                
                <div class="roulette-wrapper">
                    <div class="roulette-marker"></div>
                    <svg class="progress-ring" width="240" height="240">
                         <circle class="progress-ring-circle-bg" cx="120" cy="120" r="100"/>
                         <circle id="upgrade-circle-fg" class="progress-ring-circle" cx="120" cy="120" r="100"/>
                    </svg>
                    <div class="static-center">
                        <img src="https://i.ibb.co/rKS1f8X3/unnamed-1.jpg" class="center-logo">
                        <div class="center-content">
                            <div class="chance-text" id="u-chance">0%</div>
                            <div class="chance-sub">—à–∞–Ω—Å</div>
                        </div>
                        <div id="resultLayer" class="result-layer">
                            <span id="resultText"></span>
                        </div>
                    </div>
                </div>

                <button id="upgrade-btn" class="upgrade-btn" disabled>–ü–†–û–ö–ê–ß–ê–¢–¨</button>
            </div>
        </section>
        
        <section id="tab-profile" class="tab-content">
            <button id="back-to-my-profile" class="close-btn" style="display:none; text-align:left; color: var(--accent);" onclick="load()">‚¨Ö –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –º–æ–µ–º—É –ø—Ä–æ—Ñ–∏–ª—é</button>
            <div class="profile-header">
                <div class="profile-avatar" id="prof-avatar">üë§</div>
                <div><h2 id="profile-username">User</h2><span style="color:#666;font-size:0.8rem;font-weight:600;">–ò–≥—Ä–æ–∫</span></div>
            </div>
            <div class="stat-grid">
                <div class="stat-card"><span class="stat-val" id="prof-balance">0</span><span class="stat-label">–ë–∞–ª–∞–Ω—Å</span></div>
                <div class="stat-card"><span class="stat-val" id="prof-networth">0</span><span class="stat-label">–°–æ—Å—Ç–æ—è–Ω–∏–µ</span></div>
                <div class="stat-card"><span class="stat-val" id="prof-cases">0</span><span class="stat-label">–ö–µ–π—Å–æ–≤ –æ—Ç–∫—Ä—ã—Ç–æ</span></div>
                <div class="stat-card"><span class="stat-val" id="prof-days">0</span><span class="stat-label">–î–Ω–µ–π –≤ –∏–≥—Ä–µ</span></div>
            </div>
            <h3 style="margin:25px 0 15px; font-size: 1.1rem; color: #eee;">üéí –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å –∏–≥—Ä–æ–∫–∞</h3>
            <!-- –°—é–¥–∞ –±—É–¥–µ–º —Ä–µ–Ω–¥–µ—Ä–∏—Ç—å –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å —á—É–∂–æ–≥–æ –∏–≥—Ä–æ–∫–∞ -->
            <div id="prof-inventory" class="inventory-grid"></div>
        </section>

        <section id="tab-leaderboard" class="tab-content">
            <h2 style="text-align:center;margin-bottom:20px; font-size: 1.5rem; color: var(--accent);">üèÜ –¢–æ–ø –ë–æ–≥–∞—á–µ–π</h2>
            <div style="text-align:center; color:#888; margin-bottom:10px; font-size:0.8rem;">(–ë–∞–ª–∞–Ω—Å + –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å)</div>
            <div id="leaderboard-list"></div>
        </section>

        <section id="tab-inventory" class="tab-content">
            <div class="sell-all-container">
                <button class="main-action-btn" onclick="sellAllItems()">‚ôªÔ∏è –ü—Ä–æ–¥–∞—Ç—å –≤—Å—ë</button>
            </div>
            <div id="inventory-grid" class="inventory-grid"></div>
        </section>
    </main>

    <nav class="bottom-nav">
        <button class="nav-btn active" onclick="switchTab('cases')"><span>üì¶</span></button>
        <button class="nav-btn" onclick="switchTab('upgrade')"><span>üìà</span></button>
        <button class="nav-btn" onclick="switchTab('games')"><span>üéÆ</span></button>
        <button class="nav-btn" onclick="switchTab('inventory')"><span>üéí</span></button>
        <button class="nav-btn" onclick="switchTab('leaderboard')"><span>üèÜ</span></button>
        <button class="nav-btn" onclick="switchTab('profile')"><span>üë§</span></button>
    </nav>

    <div id="select-modal" class="item-select-modal hidden"><div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:15px"><h3 style="font-size:1.2rem;">–í—ã–±–µ—Ä–∏ –ø—Ä–µ–¥–º–µ—Ç</h3><button onclick="document.getElementById('select-modal').classList.add('hidden')" style="background:none;border:none;color:#666;font-size:2rem;line-height:1;padding:0 10px;">&times;</button></div><div id="select-grid" class="item-select-grid"></div></div>
    
    <div id="create-game-modal" class="modal hidden">
        <div class="modal-content">
            <h3>–°–æ–∑–¥–∞—Ç—å –∏–≥—Ä—É</h3>
            <div style="margin:15px 0; display:flex; gap:8px;">
                <button class="nav-btn active" style="flex:1; background:rgba(255,255,255,0.05); border-radius:12px; height:50px;" onclick="selGameType='rps'; this.parentElement.children[1].classList.remove('active'); this.classList.add('active')">‚úÇÔ∏è –ö–ù–ë</button>
                <button class="nav-btn" style="flex:1; background:rgba(255,255,255,0.05); border-radius:12px; height:50px;" onclick="selGameType='even_odd'; this.parentElement.children[0].classList.remove('active'); this.classList.add('active')">üé≤ –ß–µ—Ç/–ù–µ—á–µ—Ç</button>
            </div>
            
            <div style="background:rgba(255,255,255,0.03); border-radius:12px; padding:5px; margin:10px 0; display:flex;">
                <button id="btn-wager-money" class="nav-btn active" style="flex:1; border-radius:10px; font-size:0.9rem;" onclick="setWagerType('money')">üí∞ –î–µ–Ω—å–≥–∏</button>
                <button id="btn-wager-item" class="nav-btn" style="flex:1; border-radius:10px; font-size:0.9rem;" onclick="setWagerType('item')">üî´ –ü—Ä–µ–¥–º–µ—Ç</button>
            </div>

            <div id="wager-money-block" style="margin:20px 0">
                <label style="color:#888; font-size:0.9rem; display:block; text-align:left; margin-bottom:5px;">–°—Ç–∞–≤–∫–∞ (–ó–≤–µ–∑–¥—ã):</label>
                <input type="number" id="wager-amount" value="100" style="width:100%; padding:12px; border-radius:12px; border:1px solid rgba(255,255,255,0.1); background:#151517; color:#fff; font-size:1rem; outline:none;">
            </div>
            
            <div id="wager-item-block" style="margin:20px 0; display:none;">
                <div id="selected-wager-item" onclick="openItemSelect('wager')" style="background:rgba(255,255,255,0.05); border:1px dashed #666; border-radius:12px; padding:15px; cursor:pointer;">
                    <p style="color:#aaa;">–ù–∞–∂–º–∏, —á—Ç–æ–±—ã –≤—ã–±—Ä–∞—Ç—å –ø—Ä–µ–¥–º–µ—Ç</p>
                </div>
            </div>

            <button class="main-action-btn" onclick="createGame()">–°–û–ó–î–ê–¢–¨</button>
            <button class="close-btn" onclick="closeModal('create-game-modal')">–û—Ç–º–µ–Ω–∞</button>
        </div>
    </div>

    <div id="open-modal" class="modal hidden">
        <div class="modal-content open-case-content">
            <h3 id="modal-case-name">...</h3>
            <p class="modal-price">–¶–µ–Ω–∞: <span class="star-icon">‚≠êÔ∏è</span> <span id="modal-case-price">0</span></p>
            <div class="slider-container" style="background:rgba(255,255,255,0.03); padding:10px; border-radius:15px; margin-bottom:15px;">
                <div style="display:flex; justify-content:space-between; margin-bottom:5px; font-size:0.9rem; color:#aaa;">
                    <span>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ:</span>
                    <span id="slider-count" style="color:#fff; font-weight:bold;">1</span>
                </div>
                <input type="range" min="1" max="50" value="1" id="case-slider" oninput="updateSlider(this.value)" style="width:100%; accent-color:var(--accent);">
            </div>
            <div id="multi-roulette-container"></div>
            <div class="actions-grid">
                <button id="btn-fast" class="main-action-btn btn-fast">‚è© –ë–´–°–¢–†–û</button>
                <button id="btn-spin" class="main-action-btn btn-spin">üé∞ –ö–†–£–¢–ò–¢–¨</button>
            </div>
            <button class="close-btn" onclick="closeModal('open-modal')">–û—Ç–º–µ–Ω–∞</button>
        </div>
    </div>

    <div id="sell-modal" class="modal hidden">
        <div class="modal-content">
            <h3 id="sell-item-name">–ü—Ä–æ–¥–∞–∂–∞</h3>
            <img id="sell-item-img" src="" alt="" class="modal-main-img" style="width: 120px; height: 120px; border-radius: 20px;">
            <p style="color:#888; margin-bottom: 15px;">–í –Ω–∞–ª–∏—á–∏–∏: <span id="sell-owned-count" style="color:#fff; font-weight:bold;">0</span></p>
            <div class="slider-container" id="sell-slider-container" style="background:rgba(255,255,255,0.03); padding:10px; border-radius:15px; margin-bottom:15px;">
                <div style="display:flex; justify-content:space-between; margin-bottom:5px; font-size:0.9rem; color:#aaa;">
                    <span>–ü—Ä–æ–¥–∞—Ç—å:</span>
                    <span id="sell-slider-count" style="color:#fff; font-weight:bold;">1</span>
                </div>
                <input type="range" min="1" max="1" value="1" id="sell-slider" oninput="updateSellSlider(this.value)" style="width:100%; accent-color:var(--accent);">
            </div>
            <button id="confirm-sell-btn" class="main-action-btn" style="background: #2a2a2a; color: #ff5555; border: 1px solid rgba(255,55,55,0.3); box-shadow:none;">–ü–†–û–î–ê–¢–¨ –ó–ê <span class="star-icon">‚≠êÔ∏è</span> <span id="total-sell-price">0</span></button>
            <button class="close-btn" onclick="closeModal('sell-modal')">–û—Ç–º–µ–Ω–∞</button>
        </div>
    </div>

    <div id="details-modal" class="modal hidden">
        <div class="modal-content">
            <h3 id="det-item-name" style="color:var(--accent); text-transform:uppercase; margin-bottom:10px;">NAME</h3>
            <img id="det-item-img" src="" style="width:120px;height:120px;object-fit:cover;border-radius:20px;margin-bottom:20px;box-shadow:0 0 20px rgba(0,0,0,0.5);">
            <div id="det-rarity-badge" style="margin-bottom:15px; font-weight:800; padding:5px 10px; border-radius:8px; display:inline-block;">RARITY</div>
            
            <div class="info-row">
                <span class="info-label">–ë–∞–∑–æ–≤–∞—è —Ü–µ–Ω–∞:</span>
                <span class="info-value"><span class="star-icon">‚≠êÔ∏è</span> <span id="det-base-price">0</span></span>
            </div>
            
            <div id="det-mutations-block" style="margin-bottom:10px;">
                </div>

            <div class="info-row" style="border-top:1px solid rgba(255,255,255,0.1); padding-top:10px; margin-top:10px;">
                <span class="info-label">–ò—Ç–æ–≥–æ–≤–∞—è —Ü–µ–Ω–∞:</span>
                <span class="info-value" style="color:#33ff33; font-size:1.1rem;"><span class="star-icon">‚≠êÔ∏è</span> <span id="det-final-price">0</span></span>
            </div>

            <button class="close-btn" onclick="closeModal('details-modal')">–ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
    </div>

    <div id="drop-popup" class="popup hidden">
        <div class="popup-content">
            <div class="glow-bg"></div>
            <h2 id="drop-title" style="font-size:1.8rem; margin-bottom:15px; text-shadow:0 0 10px rgba(255,215,0,0.5);">üéâ –í–´–ü–ê–õ–û! üéâ</h2>
            <div id="drop-results-grid" class="drop-grid single"></div>
            <button id="claim-btn" class="main-action-btn">–ó–ê–ë–†–ê–¢–¨</button>
        </div>
    </div>

    <audio id="audio-player"></audio>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <!-- –ü–û–î–ö–õ–Æ–ß–ê–ï–ú –°–ö–†–ò–ü–¢–´ -->
    <script src="/static/js/script.js?v=2"></script>
</body>
</html>